module.exports=__NEXT_REGISTER_PAGE("/docs/guides/redirect",function(){var e=webpackJsonp([46],{416:function(e,t,a){e.exports=a(417)},417:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=a(0);var l=a.n(n);var o=a(3);var r=a.n(o);var c=a(6);var m=a(7);var i=a(1);var s=a(14);t["default"]=Object(c["b"])({title:"Setting up a Redirect with Now",date:"5 Nov 2017",authors:[m["h"]],editUrl:"pages/docs/guides/redirect.js"})(r()(c["a"],function(e){return l.a.createElement("div",{className:"_markdown_"},l.a.createElement(e.p,null,"You usually want your users to access your site with or without ",l.a.createElement(e.code,null,"www"),". The best way to achieve this is to redirect all the traffic coming to the ",l.a.createElement(e.code,null,"www")," domain to your app's naked domain."),l.a.createElement(e.p,null,"Here are a few example redirects:"),l.a.createElement(e.p,null,l.a.createElement(i["a"],null,"* https://www.mycompany.com -> https://mycompany.com\n* https://www.mycompany.com/about -> https://mycompany.com/about\n")),l.a.createElement(e.p,null,"You can also add two aliases to your app like below:"),l.a.createElement(e.p,null,l.a.createElement(i["a"],null,"now alias my-deployment-url.now.sh mycompany.com\nnow alias my-deployment-url.now.sh www.mycompany.com\n")),l.a.createElement(e.p,null,"It will do the job, but search engines consider them as ",l.a.createElement(e.strong,null,"duplicate")," content. This is not good for SEO and it might confuse users as well."),l.a.createElement(e.p,null,"Therefore, ",l.a.createElement(e.code,null,"www")," redirect is the best option. There are two ways to achieve that for your app."),l.a.createElement(e.h2,null,"1. Using now-examples/redirect"),l.a.createElement(e.p,null,"Now we are going to deploy a ",l.a.createElement(e.a,{href:"https://github.com/now-examples/redirect"},"simple web app")," which receives all the ",l.a.createElement(e.code,null,"www")," traffic and redirect them to your naked domain."),l.a.createElement(e.p,null,"To deploy this, run the following command:",l.a.createElement("br",null),"(Make sure to add a trailing slash to the redirect url as shown below.)"),l.a.createElement(e.p,null,l.a.createElement(s["a"],null,"now -e REDIRECT_URL=http://mycompany.com/ now-examples/redirect")),l.a.createElement(e.p,null,"Then, you will get a deployment url like this: ",l.a.createElement(e.code,null,"https://now-redirect-otytioldup.now.sh"),"."),l.a.createElement(e.p,null,"Now, alias that into your ",l.a.createElement(e.code,null,"www")," domain like this:"),l.a.createElement(e.p,null,l.a.createElement(s["a"],null,"now alias https://now-redirect-otytioldup.now.sh www.mycompany.com")),l.a.createElement(e.p,null,"Now, all the ",l.a.createElement(e.code,null,"www")," traffic will be forwarded to your naked domain (in this case ",l.a.createElement(e.code,null,"mycompany.com"),")."),l.a.createElement(e.blockquote,null,l.a.createElement(e.p,null,"You only need deploy this app once.")),l.a.createElement(e.h2,null,"2. Redirect Inside Your App"),l.a.createElement(e.p,null,"In this case, your app accepts ",l.a.createElement(e.code,null,"www")," traffic and it will redirect them from your app. If you are using ",l.a.createElement(e.a,{href:"https://expressjs.com/"},"Express")," for your app, you can do something like this:"),l.a.createElement(e.p,null,l.a.createElement(i["a"],null,"function redirect(req, res, next) {\n  // if the request doesn't come from mycompany.com or from the deployment URL\n  if (req.hostname !== 'mycompany.com' || req.hostname !== process.env.NOW_URL) {\n    // redirect to mycompany.com keeping the pathname and querystring\n    return res.redirect(`https://mycompany.com/${req.originalUrl}`);\n  }\n  return next(); // call the next middleware (or route)\n}\n\n// make Express use our redirect middleware\napp.use(redirect);\n")),l.a.createElement(e.p,null,"If you are using some other language or a different web server, you can implement a similar logic as shown above."),l.a.createElement(e.h3,null,"Set up Aliases"),l.a.createElement(e.p,null,"Now, add an additional ",l.a.createElement(e.a,{href:"/docs/getting-started/assign-a-domain-name"},"alias")," to receive ",l.a.createElement(e.code,null,"www")," traffic into your app. If you are using ",l.a.createElement(e.a,{href:"/docs/features/configuration"},"now.json"),", you can add two aliases like this:"),l.a.createElement(e.p,null,l.a.createElement(i["a"],null,'{\n  "aliases": [\n    "www.mycompany.com",\n    "mycompany.com"\n  ]\n}')),l.a.createElement(e.p,null,"Then, every time you run ",l.a.createElement(e.code,null,"now alias"),", it will alias your app into both of your aliases."))}))}},[416]);return{page:e.default}});